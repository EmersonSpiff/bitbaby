<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BitBaby</title>
  <style>
    body {
      background: #008080; /* Teal background */
      font-family: 'Arial', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      color: #228B22; /* Forest Green text */
    }

    .popup {
      background: #FFFFFF; /* White popup background */
      border: 3px solid #FFD700; /* Gold border */
      border-radius: 20px;
      padding: 20px 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      max-width: 460px;
      width: 100%;
    }

    h1 {
      text-align: center;
      color: #800020; /* Burgundy */
      margin-bottom: 15px;
      font-size: 24px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      text-align: center;
      padding: 6px 4px;
      border-bottom: 1px solid #eee;
      color: #228B22; /* Forest Green text */
    }

    .buy {
      color: #228B22; /* Forest Green */
      font-weight: bold;
    }

    .wait {
      color: #800020; /* Burgundy */
      font-weight: bold;
    }

    #refresh {
      display: block;
      margin: 15px auto 0;
      background: #008080; /* Teal */
      color: #FFFFFF;
      border: none;
      padding: 8px 14px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.2s ease-in-out;
    }

    #refresh:hover {
      background: #20B2AA; /* Turquoise */
    }

    .loading, .error {
      text-align: center;
      font-style: italic;
      padding: 15px;
      color: #800020;
    }
  </style>
</head>
<body>
  <div class="popup">
    <h1>BitBaby</h1>
    <table id="crypto-table">
      <thead>
        <tr>
          <th>Coin</th>
          <th>Price</th>
          <th>High/Low</th>
          <th>7d %</th>
          <th>Signal</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="refresh">Refresh</button>
  </div>

  <script>
    const coins = {
      bitcoin: { symbol: 'BTC', id: 'bitcoin' },
      ethereum: { symbol: 'ETH', id: 'ethereum' },
      solana: { symbol: 'SOL', id: 'solana' },
      ripple: { symbol: 'XRP', id: 'ripple' },
      hedera: { symbol: 'HBAR', id: 'hedera-hashgraph' },
      cardano: { symbol: 'ADA', id: 'cardano' },
      dogecoin: { symbol: 'DOGE', id: 'dogecoin' }
    };

    async function loadData() {
      const tbody = document.querySelector('#crypto-table tbody');
      tbody.innerHTML = '<tr><td colspan="5" class="loading">Loading...</td></tr>';

      const ids = Object.values(coins).map(c => c.id).join(',');
      const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}&sparkline=false&price_change_percentage=7d`;

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error('Failed to fetch data');
        const data = await res.json();

        tbody.innerHTML = '';

        data.forEach(coin => {
          const coinEntry = Object.values(coins).find(c => c.id === coin.id);
          const symbol = coinEntry ? coinEntry.symbol : coin.symbol.toUpperCase();
          const pct = coin.price_change_percentage_7d_in_currency;
          let signal = '';
          if (pct <= -5) signal = '<span class="buy">BUY</span>';
          else if (pct >= 5) signal = '<span class="wait">WAIT</span>';
          else signal = 'â€”';

          tbody.innerHTML += `
            <tr>
              <td>${symbol}</td>
              <td>$${coin.current_price.toLocaleString()}</td>
              <td>H: $${coin.high_24h.toLocaleString()}<br>L: $${coin.low_24h.toLocaleString()}</td>
              <td>${pct.toFixed(2)}%</td>
              <td>${signal}</td>
            </tr>`;
        });
      } catch (error) {
        tbody.innerHTML = '<tr><td colspan="5" class="error">Error fetching data. Please try again.</td></tr>';
      }
    }

    document.getElementById('refresh').addEventListener('click', loadData);
    loadData();
  </script>
</body>
</html>
